{% extends 'df_goods/base_goods.html' %}

{% block head %}
{#    <script type="text/javascript" src="js/jquery-1.12.2.js"></script>#}
    <script type="text/javascript">

        $(function () {


            function calculateTotalAmount() {

                count = $('.num_show').val();
                price = {{ goods.gprice }};

                totalAmount = parseInt(count) * parseFloat(price);
                $('#gtotal').text(totalAmount.toFixed(2) + '元')
            }

            function getInventory() {
                inventory = parseInt({{ goods.ginventory }});
                if (inventory == 0) {
                    $('div#genghuan').replaceWith("<div style='height: 60px;width: 198px;color: red;font-size: 28px;margin-top: 30px;'>没有库存了</div>");
                }
            }

            getInventory();
            calculateTotalAmount();

            $('.add').click(function () {
                count = $('.num_show').val();
                console.log(count)
                if (count < 100) {
                    count = parseFloat(count) + 1;
                    $('.num_show').val(count);
                }
                calculateTotalAmount();
            });

            $('.minus').click(function () {
                count = $('.num_show').val();
                if (count > 1) {
                    count = parseFloat(count) - 1;
                    $('.num_show').val(count);
                }
                calculateTotalAmount();
            });

            $('.num_show').blur(function () {
                count = parseInt($('.num_show').val());
                if (count < 1) {
                    count = 1;
                }
                $('.num_show').val(count)
                calculateTotalAmount()
            })


            {% comment %}
            var $add_x = $('#add_cart').offset().top;
            var $add_y = $('#add_cart').offset().left;

            var $to_x = $('#show_count').offset().top;
            var $to_y = $('#show_count').offset().left;

            $(".add_jump").css({'left':$add_y+80,'top':$add_x+10,'display':'block'})
            $('#add_cart').click(function(){
                $(".add_jump").stop().animate({
                        'left': $to_y+7,
                        'top': $to_x+7},
                    "fast", function() {
                        $(".add_jump").fadeOut('fast',function(){
                            $('#show_count').html(2);
                        });

                    });
            })
            {% endcomment %}

        })
    </script>
{% endblock head %}

{% block detail %}
    <div class="goods_detail_con clearfix">
        <div class="goods_detail_pic fl"><img src="/static/{{ goods.gimage }}" style="width: 100%"></div>

        <div class="goods_detail_list fr">
            <h3>{{ goods.gname }}</h3>
            <p>{{ goods.gbrief_introduction }}</p>
            <div class="prize_bar">
                <span class="show_pirze">¥<em>{{ goods.gprice }}</em></span>
                <span class="show_unit">单  位：{{ goods.gunit }}</span>
            </div>
            <div id="genghuan">
                <div class="goods_num clearfix">
                    <div class="num_name fl">数 量：</div>
                    <div class="num_add fl">
                        <input type="text" class="num_show fl" value="1" id="num_show">
                        <a id="add" href="javascript:;" class="add fr">+</a>
                        <a id="minus" href="javascript:;" class="minus fr">-</a>
                    </div>
                    <div style="margin-left: 350px;line-height: 53px;overflow: hidden;">
                        <div style="width: 77px;height: 52px; float: left">库 存：</div>
                        <div style="border: 1px solid #dddddd;width: 77px;height: 52px;text-align: center;line-height: 53px;
                                overflow: hidden;font-size: 20px;" id="kucun">{{ goods.ginventory }}</div>
                    </div>
                </div>
                <div class="total">总价：<em id="gtotal">16.80元</em></div>
                <div class="operate_btn">
                    <a href="javascript:;" class="buy_btn">立即购买</a>
                    <a href="javascript:;" class="add_cart" id="add_cart">加入购物车</a>
                </div>
            </div>

        </div>
    </div>

{% endblock detail %}

{% block list %}
    <div class="r_wrap fr clearfix">
        <ul class="detail_tab clearfix">
            <li class="active">商品介绍</li>
            <li>评论</li>
        </ul>

        <div class="tab_content">
            <dl>
                <dt>商品详情：</dt>
                <dd>{{ goods.gdetailed_introduction|safe }}</dd>
            </dl>
        </div>

    </div>
{% endblock list %}




	
